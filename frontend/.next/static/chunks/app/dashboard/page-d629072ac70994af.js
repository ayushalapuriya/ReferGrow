(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[105],{457:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>d});var t=s(5155),l=s(8500),a=s.n(l),n=s(2115),i=s(866);function d(){let[e,r]=(0,n.useState)(null),[s,l]=(0,n.useState)([]),[d,o]=(0,n.useState)([]),[c,x]=(0,n.useState)(""),[m,p]=(0,n.useState)(!1),[h,u]=(0,n.useState)(null),b=(0,n.useMemo)(()=>d.reduce((e,r)=>e+(r.amount??0),0),[d]);async function f(){u(null);let[e,s,t]=await Promise.all([(0,i.n)("/api/me"),(0,i.n)("/api/services"),(0,i.n)("/api/income")]),a=await e.json();if(!e.ok)throw Error(a?.error??"Not logged in");let n=await s.json(),d=await t.json();r(a.user),l(n.services??[]),o(d.incomes??[]);let c=n.services?.[0]?._id??"";x(e=>e||c)}async function g(){p(!0);try{await (0,i.n)("/api/auth/logout",{method:"POST"}),window.location.href="/login"}finally{p(!1)}}async function j(){if(c){p(!0),u(null);try{let e=await (0,i.n)("/api/purchases",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({serviceId:c})}),r=await e.json();if(!e.ok)throw Error(r?.error??"Purchase failed");await f()}catch(e){u(e instanceof Error?e.message:String(e))}finally{p(!1)}}}return((0,n.useEffect)(()=>{f().catch(e=>u(e instanceof Error?e.message:String(e)))},[]),h&&!e)?(0,t.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-purple-50 via-blue-50 to-indigo-50 dark:from-gray-900 dark:via-purple-900/20 dark:to-indigo-900/20 p-6",children:(0,t.jsxs)("div",{className:"mx-auto max-w-2xl",children:[(0,t.jsx)("h1",{className:"text-3xl font-bold bg-gradient-to-r from-purple-600 to-blue-600 bg-clip-text text-transparent",children:"Dashboard"}),(0,t.jsxs)("div",{className:"mt-4 glass-panel animate-fade-in rounded-xl border border-red-500/20 bg-red-500/10 p-6 text-sm backdrop-blur-xl",children:[h," —"," ",(0,t.jsx)(a(),{className:"font-semibold underline transition-colors hover:text-purple-600",href:"/login",children:"Login"})]})]})}):(0,t.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-purple-50 via-blue-50 to-indigo-50 dark:from-gray-900 dark:via-purple-900/20 dark:to-indigo-900/20 p-6",children:(0,t.jsxs)("div",{className:"mx-auto max-w-6xl",children:[(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row items-start justify-between gap-4 mb-8",children:[(0,t.jsxs)("div",{className:"animate-fade-in",children:[(0,t.jsx)("h1",{className:"text-4xl font-bold bg-gradient-to-r from-purple-600 to-blue-600 bg-clip-text text-transparent",children:"Dashboard"}),e?(0,t.jsxs)("p",{className:"mt-2 text-sm text-zinc-600 dark:text-zinc-400",children:["Welcome back, ",(0,t.jsx)("span",{className:"font-semibold text-purple-600 dark:text-purple-400",children:e.email})," (",e.role,")"]}):null]}),(0,t.jsxs)("div",{className:"flex gap-3 animate-slide-in",children:[e?.role==="admin"?(0,t.jsx)(a(),{className:"glass-panel rounded-xl px-5 py-2.5 text-sm font-medium transition-all hover:scale-105 hover:shadow-lg border border-purple-200 dark:border-purple-500/30",href:"/admin/services",children:(0,t.jsx)("span",{className:"bg-gradient-to-r from-purple-600 to-blue-600 bg-clip-text text-transparent",children:"Admin Panel"})}):null,(0,t.jsx)("button",{className:"glass-panel rounded-xl px-5 py-2.5 text-sm font-medium disabled:opacity-60 transition-all hover:scale-105 hover:shadow-lg border border-purple-200 dark:border-purple-500/30",onClick:g,disabled:m,children:"Logout"})]})]}),h?(0,t.jsx)("div",{className:"mb-6 glass-panel animate-shake rounded-xl border border-red-500/30 bg-red-500/10 p-4 text-sm text-red-700 dark:text-red-300 backdrop-blur-xl",children:h}):null,e?(0,t.jsxs)("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3 mb-8",children:[(0,t.jsxs)("div",{className:"glass-panel animate-fade-in rounded-2xl border border-purple-200 dark:border-purple-500/30 p-6 transition-all hover:scale-105 hover:shadow-2xl",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,t.jsx)("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-br from-purple-500 to-blue-500 flex items-center justify-center text-white text-xl",children:"\uD83D\uDD17"}),(0,t.jsx)("h2",{className:"font-semibold text-lg",children:"Referral Code"})]}),(0,t.jsx)("div",{className:"mt-2 flex items-center justify-between gap-2 rounded-xl bg-gradient-to-r from-purple-500/10 to-blue-500/10 px-4 py-3 border border-purple-200 dark:border-purple-500/30",children:(0,t.jsx)("code",{className:"text-lg font-bold bg-gradient-to-r from-purple-600 to-blue-600 bg-clip-text text-transparent",children:e.referralCode})}),(0,t.jsx)("p",{className:"mt-3 text-xs text-zinc-600 dark:text-zinc-400",children:"Share this code to invite new users to your network"})]}),(0,t.jsxs)("div",{className:"glass-panel animate-fade-in rounded-2xl border border-green-200 dark:border-green-500/30 p-6 transition-all hover:scale-105 hover:shadow-2xl",style:{animationDelay:"0.1s"},children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,t.jsx)("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-br from-green-500 to-emerald-500 flex items-center justify-center text-white text-xl",children:"\uD83D\uDCB0"}),(0,t.jsx)("h2",{className:"font-semibold text-lg",children:"Total Income"})]}),(0,t.jsxs)("p",{className:"mt-2 text-4xl font-bold bg-gradient-to-r from-green-600 to-emerald-600 bg-clip-text text-transparent animate-pulse-slow",children:["$",b.toFixed(2)]}),(0,t.jsx)("p",{className:"mt-3 text-xs text-zinc-600 dark:text-zinc-400",children:"Cumulative BV income from your network"})]}),(0,t.jsxs)("div",{className:"glass-panel animate-fade-in rounded-2xl border border-blue-200 dark:border-blue-500/30 p-6 transition-all hover:scale-105 hover:shadow-2xl md:col-span-2 lg:col-span-1",style:{animationDelay:"0.2s"},children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,t.jsx)("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-br from-blue-500 to-indigo-500 flex items-center justify-center text-white text-xl",children:"\uD83D\uDCCA"}),(0,t.jsx)("h2",{className:"font-semibold text-lg",children:"Quick Stats"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,t.jsx)("span",{className:"text-zinc-600 dark:text-zinc-400",children:"Income Entries"}),(0,t.jsx)("span",{className:"font-semibold",children:d.length})]}),(0,t.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,t.jsx)("span",{className:"text-zinc-600 dark:text-zinc-400",children:"Available Services"}),(0,t.jsx)("span",{className:"font-semibold",children:s.length})]})]})]})]}):null,(0,t.jsxs)("div",{className:"glass-panel animate-fade-in rounded-2xl border border-purple-200 dark:border-purple-500/30 p-6 mb-6 transition-all hover:shadow-2xl",style:{animationDelay:"0.3s"},children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,t.jsx)("div",{className:"w-10 h-10 rounded-lg bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center text-white",children:"\uD83D\uDED2"}),(0,t.jsx)("h2",{className:"font-semibold text-lg",children:"Purchase Service"})]}),(0,t.jsxs)("div",{className:"mt-4 flex flex-col gap-3 sm:flex-row sm:items-center",children:[(0,t.jsx)("select",{className:"flex-1 glass-panel rounded-xl border border-purple-200 dark:border-purple-500/30 px-4 py-3 font-medium transition-all focus:ring-2 focus:ring-purple-500",value:c,onChange:e=>x(e.target.value),children:s.map(e=>(0,t.jsxs)("option",{value:e._id,children:[e.name," — $",e.price," — BV ",e.businessVolume]},e._id))}),(0,t.jsx)("button",{className:"rounded-xl bg-gradient-to-r from-purple-600 to-blue-600 px-6 py-3 text-sm font-semibold text-white transition-all hover:scale-105 hover:shadow-xl disabled:opacity-60 disabled:hover:scale-100",onClick:j,disabled:m||!c,children:m?"Processing…":"Buy Now"})]}),0===s.length?(0,t.jsx)("p",{className:"mt-3 text-xs text-zinc-600 dark:text-zinc-400",children:"No services available. Admin needs to create services first."}):null]}),(0,t.jsxs)("div",{className:"glass-panel animate-fade-in rounded-2xl border border-purple-200 dark:border-purple-500/30 p-6 transition-all hover:shadow-2xl",style:{animationDelay:"0.4s"},children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-10 h-10 rounded-lg bg-gradient-to-br from-blue-500 to-cyan-500 flex items-center justify-center text-white",children:"\uD83D\uDCC8"}),(0,t.jsx)("h2",{className:"font-semibold text-lg",children:"Income History"})]}),(0,t.jsx)(a(),{className:"text-sm font-medium bg-gradient-to-r from-purple-600 to-blue-600 bg-clip-text text-transparent hover:underline transition-all hover:scale-105",href:"/referrals",children:"View Referral Tree →"})]}),(0,t.jsx)("div",{className:"mt-4 overflow-auto rounded-xl border border-purple-200 dark:border-purple-500/30",children:(0,t.jsxs)("table",{className:"w-full text-sm",children:[(0,t.jsx)("thead",{className:"bg-gradient-to-r from-purple-500/10 to-blue-500/10 text-left text-zinc-700 dark:text-zinc-300",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"py-3 px-4 font-semibold",children:"Date"}),(0,t.jsx)("th",{className:"py-3 px-4 font-semibold",children:"From"}),(0,t.jsx)("th",{className:"py-3 px-4 font-semibold",children:"Level"}),(0,t.jsx)("th",{className:"py-3 px-4 font-semibold",children:"BV"}),(0,t.jsx)("th",{className:"py-3 px-4 font-semibold",children:"Amount"})]})}),(0,t.jsxs)("tbody",{children:[d.map((e,r)=>(0,t.jsxs)("tr",{className:"border-t border-purple-200 dark:border-purple-500/30 hover:bg-purple-500/5 transition-colors",children:[(0,t.jsx)("td",{className:"py-3 px-4",children:new Date(e.createdAt).toLocaleString()}),(0,t.jsx)("td",{className:"py-3 px-4 font-medium",children:e.fromUser?.email??"—"}),(0,t.jsx)("td",{className:"py-3 px-4",children:(0,t.jsxs)("span",{className:"px-2 py-1 rounded-lg bg-blue-500/10 text-blue-700 dark:text-blue-300 text-xs font-semibold",children:["L",e.level]})}),(0,t.jsx)("td",{className:"py-3 px-4 font-medium",children:e.bv}),(0,t.jsxs)("td",{className:"py-3 px-4 font-bold text-green-600 dark:text-green-400",children:["$",e.amount.toFixed(2)]})]},e._id)),0===d.length?(0,t.jsx)("tr",{children:(0,t.jsx)("td",{className:"py-8 text-center text-zinc-600 dark:text-zinc-400",colSpan:5,children:"No income entries yet. Purchase services to start earning!"})}):null]})]})})]})]})})}},721:(e,r,s)=>{Promise.resolve().then(s.bind(s,457))},866:(e,r,s)=>{"use strict";s.d(r,{n:()=>l});let t="http://localhost:4000";function l(e,r={}){let s=function(e){let r=t?t.endsWith("/")?t.slice(0,-1):t:"";if(!r)return e;let s=e.startsWith("/")?e:`/${e}`;return`${r}${s}`}(e),a=r.credentials??"include";return fetch(s,{...r,credentials:a})}}},e=>{e.O(0,[500,441,794,358],()=>e(e.s=721)),_N_E=e.O()}]);