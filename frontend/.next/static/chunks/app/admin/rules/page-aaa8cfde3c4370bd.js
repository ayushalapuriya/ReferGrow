(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[346],{866:(e,t,r)=>{"use strict";r.d(t,{n:()=>a});let s="http://localhost:4000";function a(e,t={}){let r=function(e){let t=s?s.endsWith("/")?s.slice(0,-1):s:"";if(!t)return e;let r=e.startsWith("/")?e:`/${e}`;return`${t}${r}`}(e),l=t.credentials??"include";return fetch(r,{...t,credentials:l})}},1686:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>d});var s=r(5155),a=r(8500),l=r.n(a),n=r(2115),i=r(866);function d(){let[e,t]=(0,n.useState)([]),[r,a]=(0,n.useState)(10),[d,c]=(0,n.useState)(!0),[o,x]=(0,n.useState)(null),[p,m]=(0,n.useState)(!1);async function u(){x(null);let e=await (0,i.n)("/api/admin/rules"),r=await e.json();if(!e.ok)throw Error(r?.error??"Failed to load");t(r.recentRules??[])}async function h(e){e.preventDefault(),m(!0),x(null);try{let e=await (0,i.n)("/api/admin/rules",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({basePercentage:r,decayEnabled:d,isActive:!0})}),t=await e.json();if(!e.ok)throw Error(t?.error??"Create failed");await u()}catch(e){x(e instanceof Error?e.message:String(e))}finally{m(!1)}}async function b(e){m(!0),x(null);try{let t=await (0,i.n)(`/api/admin/rules/${e._id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({isActive:!0})}),r=await t.json();if(!t.ok)throw Error(r?.error??"Update failed");await u()}catch(e){x(e instanceof Error?e.message:String(e))}finally{m(!1)}}return(0,n.useEffect)(()=>{u().catch(e=>x(String(e?.message??e)))},[]),(0,s.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-purple-50 via-blue-50 to-indigo-50 dark:from-gray-900 dark:via-purple-900/20 dark:to-indigo-900/20 p-6",children:(0,s.jsxs)("div",{className:"mx-auto max-w-6xl",children:[(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4 mb-8",children:[(0,s.jsxs)("div",{className:"animate-fade-in",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,s.jsx)("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-br from-blue-500 to-cyan-500 flex items-center justify-center text-white text-2xl",children:"\uD83D\uDCCA"}),(0,s.jsx)("h1",{className:"text-4xl font-bold bg-gradient-to-r from-blue-600 to-cyan-600 bg-clip-text text-transparent",children:"Income Rules"})]}),(0,s.jsx)("p",{className:"text-sm text-zinc-600 dark:text-zinc-400 ml-15",children:"Configure BV income distribution rules"})]}),(0,s.jsxs)("div",{className:"flex gap-3 animate-slide-in",children:[(0,s.jsx)(l(),{className:"glass-panel rounded-xl px-5 py-2.5 text-sm font-medium transition-all hover:scale-105 hover:shadow-lg border border-purple-200 dark:border-purple-500/30",href:"/admin/services",children:"Services"}),(0,s.jsx)(l(),{className:"glass-panel rounded-xl px-5 py-2.5 text-sm font-medium transition-all hover:scale-105 hover:shadow-lg border border-purple-200 dark:border-purple-500/30",href:"/dashboard",children:"Dashboard"})]})]}),o?(0,s.jsxs)("div",{className:"mb-6 glass-panel animate-shake rounded-xl border border-red-500/30 bg-red-500/10 p-4 text-sm text-red-700 dark:text-red-300",children:["⚠️ ",o]}):null,(0,s.jsxs)("form",{className:"glass-panel animate-fade-in rounded-2xl border border-purple-200 dark:border-purple-500/30 p-6 mb-6",onSubmit:h,style:{animationDelay:"0.1s"},children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,s.jsx)("div",{className:"w-10 h-10 rounded-lg bg-gradient-to-br from-green-500 to-emerald-500 flex items-center justify-center text-white text-xl",children:"➕"}),(0,s.jsx)("h2",{className:"font-bold text-xl",children:"Create New Rule"})]}),(0,s.jsxs)("div",{className:"grid gap-4 md:grid-cols-3",children:[(0,s.jsxs)("div",{className:"space-y-2 md:col-span-2",children:[(0,s.jsx)("label",{className:"text-sm font-semibold text-zinc-700 dark:text-zinc-300",children:"Level 1 Percentage (of BV)"}),(0,s.jsx)("input",{className:"w-full glass-panel rounded-xl border border-purple-200 dark:border-purple-500/30 px-4 py-3 font-medium transition-all focus:ring-2 focus:ring-purple-500",type:"number",step:"0.01",value:r,onChange:e=>a(Number(e.target.value)),min:0,max:100,required:!0}),(0,s.jsx)("p",{className:"text-xs text-zinc-600 dark:text-zinc-400 pl-1",children:"\uD83D\uDCA1 Example: 10 = 10% income at Level 1"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{className:"text-sm font-semibold text-zinc-700 dark:text-zinc-300",children:"Decay Mode"}),(0,s.jsxs)("label",{className:"flex items-start gap-3 glass-panel rounded-xl border border-purple-200 dark:border-purple-500/30 p-4 cursor-pointer hover:bg-purple-500/5 transition-colors",children:[(0,s.jsx)("input",{className:"mt-1 w-4 h-4 accent-purple-600",type:"checkbox",checked:d,onChange:e=>c(e.target.checked)}),(0,s.jsxs)("span",{className:"text-sm text-zinc-700 dark:text-zinc-300",children:["Halve each level",(0,s.jsx)("br",{}),(0,s.jsx)("span",{className:"text-xs text-zinc-600 dark:text-zinc-400",children:"(L2 = 50% of L1, etc.)"})]})]})]})]}),(0,s.jsx)("button",{className:"mt-4 rounded-xl bg-gradient-to-r from-purple-600 to-blue-600 px-6 py-3 text-sm font-semibold text-white transition-all hover:scale-105 hover:shadow-xl disabled:opacity-60 disabled:hover:scale-100",disabled:p,type:"submit",children:p?"Saving...":"Create & Set Active"})]}),(0,s.jsxs)("div",{className:"glass-panel animate-fade-in rounded-2xl border border-purple-200 dark:border-purple-500/30 p-6",style:{animationDelay:"0.2s"},children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,s.jsx)("div",{className:"w-10 h-10 rounded-lg bg-gradient-to-br from-blue-500 to-cyan-500 flex items-center justify-center text-white text-xl",children:"\uD83D\uDCCB"}),(0,s.jsx)("h2",{className:"font-bold text-xl",children:"All Rules"})]}),(0,s.jsx)("div",{className:"overflow-auto rounded-xl border border-purple-200 dark:border-purple-500/30",children:(0,s.jsxs)("table",{className:"w-full text-sm",children:[(0,s.jsx)("thead",{className:"bg-gradient-to-r from-purple-500/10 to-blue-500/10 text-left text-zinc-700 dark:text-zinc-300",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"py-3 px-4 font-semibold",children:"Level 1"}),(0,s.jsx)("th",{className:"py-3 px-4 font-semibold",children:"Decay"}),(0,s.jsx)("th",{className:"py-3 px-4 font-semibold",children:"Active"}),(0,s.jsx)("th",{className:"py-3 px-4 font-semibold text-right",children:"Actions"})]})}),(0,s.jsxs)("tbody",{children:[e.map(e=>(0,s.jsxs)("tr",{className:"border-t border-purple-200 dark:border-purple-500/30 hover:bg-purple-500/5 transition-colors",children:[(0,s.jsx)("td",{className:"py-3 px-4",children:(0,s.jsxs)("span",{className:"font-bold text-blue-600 dark:text-blue-400",children:[(100*e.basePercentage).toFixed(2),"%"]})}),(0,s.jsx)("td",{className:"py-3 px-4",children:e.decayEnabled?(0,s.jsx)("span",{className:"px-2 py-1 rounded-lg bg-purple-500/10 text-purple-700 dark:text-purple-300 text-xs font-semibold",children:"Halving"}):(0,s.jsx)("span",{className:"px-2 py-1 rounded-lg bg-gray-500/10 text-gray-700 dark:text-gray-300 text-xs font-semibold",children:"Level 1 only"})}),(0,s.jsx)("td",{className:"py-3 px-4",children:e.isActive?(0,s.jsx)("span",{className:"px-2 py-1 rounded-lg bg-green-500/10 text-green-700 dark:text-green-300 text-xs font-semibold",children:"✓ Active"}):(0,s.jsx)("span",{className:"px-2 py-1 rounded-lg bg-gray-500/10 text-gray-700 dark:text-gray-300 text-xs font-semibold",children:"Inactive"})}),(0,s.jsx)("td",{className:"py-3 px-4 text-right",children:(0,s.jsx)("button",{className:"glass-panel rounded-lg px-4 py-1.5 text-xs font-medium disabled:opacity-60 border border-purple-200 dark:border-purple-500/30 hover:bg-purple-500/10 transition-colors",onClick:()=>b(e),disabled:p||e.isActive,children:e.isActive?"✓ Active":"Set Active"})})]},e._id)),0===e.length?(0,s.jsx)("tr",{children:(0,s.jsx)("td",{className:"py-8 text-center text-zinc-600 dark:text-zinc-400",colSpan:4,children:"No rules yet. Create your first rule above!"})}):null]})]})}),(0,s.jsx)("div",{className:"mt-4 p-4 rounded-xl bg-gradient-to-r from-blue-500/10 to-cyan-500/10 border border-blue-200 dark:border-blue-500/30",children:(0,s.jsxs)("div",{className:"flex items-start gap-3",children:[(0,s.jsx)("span",{className:"text-2xl",children:"\uD83D\uDCA1"}),(0,s.jsxs)("div",{className:"text-xs text-zinc-600 dark:text-zinc-400",children:[(0,s.jsx)("strong",{className:"text-blue-600 dark:text-blue-400",children:"Formula:"})," Income per level = BV \xd7 Level-1% \xd7 (1/2)^(level-1) when decay is enabled."]})]})})]})]})})}},5109:(e,t,r)=>{Promise.resolve().then(r.bind(r,1686))}},e=>{e.O(0,[500,441,794,358],()=>e(e.s=5109)),_N_E=e.O()}]);